!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=20)}([function(e,t,n){var r,o,i=n(9),c=n(23),s=n(25),u=n(27),a=n(13);function l(e,t){Object.defineProperty(e,r,{get:function(){return t}})}"function"==typeof Symbol&&"function"==typeof Symbol.for?(r=Symbol.for("graceful-fs.queue"),o=Symbol.for("graceful-fs.previous")):(r="___graceful-fs.queue",o="___graceful-fs.previous");var f,d=function(){};if(a.debuglog?d=a.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(d=function(){var e=a.format.apply(a,arguments);e="GFS4: "+e.split(/\n/).join("\nGFS4: "),console.error(e)}),!i[r]){var y=global[r]||[];l(i,y),i.close=function(e){function t(t,n){return e.call(i,t,(function(e){e||h(),"function"==typeof n&&n.apply(this,arguments)}))}return Object.defineProperty(t,o,{value:e}),t}(i.close),i.closeSync=function(e){function t(t){e.apply(i,arguments),h()}return Object.defineProperty(t,o,{value:e}),t}(i.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",(function(){d(i[r]),n(14).equal(i[r].length,0)}))}function p(e){c(e),e.gracefulify=p,e.createReadStream=function(t,n){return new e.ReadStream(t,n)},e.createWriteStream=function(t,n){return new e.WriteStream(t,n)};var t=e.readFile;e.readFile=function(e,n,r){"function"==typeof n&&(r=n,n=null);return function e(n,r,o,i){return t(n,r,(function(t){!t||"EMFILE"!==t.code&&"ENFILE"!==t.code?"function"==typeof o&&o.apply(this,arguments):m([e,[n,r,o],t,i||Date.now(),Date.now()])}))}(e,n,r)};var n=e.writeFile;e.writeFile=function(e,t,r,o){"function"==typeof r&&(o=r,r=null);return function e(t,r,o,i,c){return n(t,r,o,(function(n){!n||"EMFILE"!==n.code&&"ENFILE"!==n.code?"function"==typeof i&&i.apply(this,arguments):m([e,[t,r,o,i],n,c||Date.now(),Date.now()])}))}(e,t,r,o)};var r=e.appendFile;r&&(e.appendFile=function(e,t,n,o){"function"==typeof n&&(o=n,n=null);return function e(t,n,o,i,c){return r(t,n,o,(function(r){!r||"EMFILE"!==r.code&&"ENFILE"!==r.code?"function"==typeof i&&i.apply(this,arguments):m([e,[t,n,o,i],r,c||Date.now(),Date.now()])}))}(e,t,n,o)});var o=e.copyFile;o&&(e.copyFile=function(e,t,n,r){"function"==typeof n&&(r=n,n=0);return function e(t,n,r,i,c){return o(t,n,r,(function(o){!o||"EMFILE"!==o.code&&"ENFILE"!==o.code?"function"==typeof i&&i.apply(this,arguments):m([e,[t,n,r,i],o,c||Date.now(),Date.now()])}))}(e,t,n,r)});var i=e.readdir;if(e.readdir=function(e,t,n){"function"==typeof t&&(n=t,t=null);return function e(t,n,r,o){return i(t,n,(function(i,c){!i||"EMFILE"!==i.code&&"ENFILE"!==i.code?(c&&c.sort&&c.sort(),"function"==typeof r&&r.call(this,i,c)):m([e,[t,n,r],i,o||Date.now(),Date.now()])}))}(e,t,n)},"v0.8"===process.version.substr(0,4)){var u=s(e);y=u.ReadStream,h=u.WriteStream}var a=e.ReadStream;a&&(y.prototype=Object.create(a.prototype),y.prototype.open=function(){var e=this;v(e.path,e.flags,e.mode,(function(t,n){t?(e.autoClose&&e.destroy(),e.emit("error",t)):(e.fd=n,e.emit("open",n),e.read())}))});var l=e.WriteStream;l&&(h.prototype=Object.create(l.prototype),h.prototype.open=function(){var e=this;v(e.path,e.flags,e.mode,(function(t,n){t?(e.destroy(),e.emit("error",t)):(e.fd=n,e.emit("open",n))}))}),Object.defineProperty(e,"ReadStream",{get:function(){return y},set:function(e){y=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"WriteStream",{get:function(){return h},set:function(e){h=e},enumerable:!0,configurable:!0});var f=y;Object.defineProperty(e,"FileReadStream",{get:function(){return f},set:function(e){f=e},enumerable:!0,configurable:!0});var d=h;function y(e,t){return this instanceof y?(a.apply(this,arguments),this):y.apply(Object.create(y.prototype),arguments)}function h(e,t){return this instanceof h?(l.apply(this,arguments),this):h.apply(Object.create(h.prototype),arguments)}Object.defineProperty(e,"FileWriteStream",{get:function(){return d},set:function(e){d=e},enumerable:!0,configurable:!0});var S=e.open;function v(e,t,n,r){return"function"==typeof n&&(r=n,n=null),function e(t,n,r,o,i){return S(t,n,r,(function(c,s){!c||"EMFILE"!==c.code&&"ENFILE"!==c.code?"function"==typeof o&&o.apply(this,arguments):m([e,[t,n,r,o],c,i||Date.now(),Date.now()])}))}(e,t,n,r)}return e.open=v,e}function m(e){d("ENQUEUE",e[0].name,e[1]),i[r].push(e),S()}function h(){for(var e=Date.now(),t=0;t<i[r].length;++t)i[r][t].length>2&&(i[r][t][3]=e,i[r][t][4]=e);S()}function S(){if(clearTimeout(f),f=void 0,0!==i[r].length){var e=i[r].shift(),t=e[0],n=e[1],o=e[2],c=e[3],s=e[4];if(void 0===c)d("RETRY",t.name,n),t.apply(null,n);else if(Date.now()-c>=6e4){d("TIMEOUT",t.name,n);var u=n.pop();"function"==typeof u&&u.call(null,o)}else{var a=Date.now()-s,l=Math.max(s-c,1);a>=Math.min(1.2*l,100)?(d("RETRY",t.name,n),t.apply(null,n.concat([c]))):i[r].push(e)}void 0===f&&(f=setTimeout(S,0))}}global[r]||l(global,i[r]),e.exports=p(u(i)),process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!i.__patched&&(e.exports=p(i),i.__patched=!0)},function(e,t){e.exports=require("path")},function(e,t,n){"use strict";t.fromCallback=function(e){return Object.defineProperty((function(...t){if("function"!=typeof t[t.length-1])return new Promise((n,r)=>{e.call(this,...t,(e,t)=>null!=e?r(e):n(t))});e.apply(this,t)}),"name",{value:e.name})},t.fromPromise=function(e){return Object.defineProperty((function(...t){const n=t[t.length-1];if("function"!=typeof n)return e.apply(this,t);e.apply(this,t.slice(0,-1)).then(e=>n(null,e),n)}),"name",{value:e.name})}},function(e,t,n){"use strict";const r=n(2).fromPromise,{makeDir:o,makeDirSync:i}=n(29),c=r(o);e.exports={mkdirs:c,mkdirsSync:i,mkdirp:c,mkdirpSync:i,ensureDir:c,ensureDirSync:i}},function(e,t,n){"use strict";const r=n(2).fromPromise,o=n(5);e.exports={pathExists:r((function(e){return o.access(e).then(()=>!0).catch(()=>!1)})),pathExistsSync:o.existsSync}},function(e,t,n){"use strict";const r=n(2).fromCallback,o=n(0),i=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchmod","lchown","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(e=>"function"==typeof o[e]);Object.keys(o).forEach(e=>{"promises"!==e&&(t[e]=o[e])}),i.forEach(e=>{t[e]=r(o[e])}),t.exists=function(e,t){return"function"==typeof t?o.exists(e,t):new Promise(t=>o.exists(e,t))},t.read=function(e,t,n,r,i,c){return"function"==typeof c?o.read(e,t,n,r,i,c):new Promise((c,s)=>{o.read(e,t,n,r,i,(e,t,n)=>{if(e)return s(e);c({bytesRead:t,buffer:n})})})},t.write=function(e,t,...n){return"function"==typeof n[n.length-1]?o.write(e,t,...n):new Promise((r,i)=>{o.write(e,t,...n,(e,t,n)=>{if(e)return i(e);r({bytesWritten:t,buffer:n})})})},"function"==typeof o.writev&&(t.writev=function(e,t,...n){return"function"==typeof n[n.length-1]?o.writev(e,t,...n):new Promise((r,i)=>{o.writev(e,t,...n,(e,t,n)=>{if(e)return i(e);r({bytesWritten:t,buffers:n})})})}),"function"==typeof o.realpath.native&&(t.realpath.native=r(o.realpath.native))},function(e,t,n){"use strict";const r=n(5),o=n(1),i=n(13),c=n(16)("10.5.0"),s=e=>c?r.stat(e,{bigint:!0}):r.stat(e),u=e=>c?r.statSync(e,{bigint:!0}):r.statSync(e);function a(e,t){return Promise.all([s(e),s(t).catch(e=>{if("ENOENT"===e.code)return null;throw e})]).then(([e,t])=>({srcStat:e,destStat:t}))}function l(e,t){if(t.ino&&t.dev&&t.ino===e.ino&&t.dev===e.dev){if(c||t.ino<Number.MAX_SAFE_INTEGER)return!0;if(t.size===e.size&&t.mode===e.mode&&t.nlink===e.nlink&&t.atimeMs===e.atimeMs&&t.mtimeMs===e.mtimeMs&&t.ctimeMs===e.ctimeMs&&t.birthtimeMs===e.birthtimeMs)return!0}return!1}function f(e,t){const n=o.resolve(e).split(o.sep).filter(e=>e),r=o.resolve(t).split(o.sep).filter(e=>e);return n.reduce((e,t,n)=>e&&r[n]===t,!0)}function d(e,t,n){return`Cannot ${n} '${e}' to a subdirectory of itself, '${t}'.`}e.exports={checkPaths:function(e,t,n,r){i.callbackify(a)(e,t,(o,i)=>{if(o)return r(o);const{srcStat:c,destStat:s}=i;return s&&l(c,s)?r(new Error("Source and destination must not be the same.")):c.isDirectory()&&f(e,t)?r(new Error(d(e,t,n))):r(null,{srcStat:c,destStat:s})})},checkPathsSync:function(e,t,n){const{srcStat:r,destStat:o}=function(e,t){let n;const r=u(e);try{n=u(t)}catch(e){if("ENOENT"===e.code)return{srcStat:r,destStat:null};throw e}return{srcStat:r,destStat:n}}(e,t);if(o&&l(r,o))throw new Error("Source and destination must not be the same.");if(r.isDirectory()&&f(e,t))throw new Error(d(e,t,n));return{srcStat:r,destStat:o}},checkParentPaths:function e(t,n,i,s,u){const a=o.resolve(o.dirname(t)),f=o.resolve(o.dirname(i));if(f===a||f===o.parse(f).root)return u();const y=(r,o)=>r?"ENOENT"===r.code?u():u(r):l(n,o)?u(new Error(d(t,i,s))):e(t,n,f,s,u);c?r.stat(f,{bigint:!0},y):r.stat(f,y)},checkParentPathsSync:function e(t,n,r,i){const c=o.resolve(o.dirname(t)),s=o.resolve(o.dirname(r));if(s===c||s===o.parse(s).root)return;let a;try{a=u(s)}catch(e){if("ENOENT"===e.code)return;throw e}if(l(n,a))throw new Error(d(t,r,i));return e(t,n,s,i)},isSrcSubdir:f}},function(e,t,n){"use strict";const r=n(2).fromCallback,o=n(32);e.exports={remove:r(o),removeSync:o.sync}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=joplin},function(e,t){e.exports=require("fs")},function(e,t){e.exports={stringify:function(e,{EOL:t="\n",finalEOL:n=!0,replacer:r=null,spaces:o}={}){const i=n?t:"";return JSON.stringify(e,r,o).replace(/\n/g,t)+i},stripBom:function(e){return Buffer.isBuffer(e)&&(e=e.toString("utf8")),e.replace(/^\uFEFF/,"")}}},function(e,t,n){"use strict";const r=n(2).fromCallback,o=n(0),i=n(1),c=n(3),s=n(4).pathExists;e.exports={outputFile:r((function(e,t,n,r){"function"==typeof n&&(r=n,n="utf8");const u=i.dirname(e);s(u,(i,s)=>i?r(i):s?o.writeFile(e,t,n,r):void c.mkdirs(u,i=>{if(i)return r(i);o.writeFile(e,t,n,r)}))})),outputFileSync:function(e,...t){const n=i.dirname(e);if(o.existsSync(n))return o.writeFileSync(e,...t);c.mkdirsSync(n),o.writeFileSync(e,...t)}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function c(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.syncConfiguredAndRunOnStart=t.createResources=t.deleteResources=t.init=void 0;const o=n(21),i=n(1),c=n(22);let s,u,a;const l=/^[a-zA-Z0-9]{32}$/,f=/^.*~[a-zA-Z0-9]{32}~.*~[0-9]{13}.REPLACE$/,d="Step 1 - Resource Deleted Sync Needed";function y(){return r(this,void 0,void 0,(function*(){const e=c.readdirSync(s);let t=!1;for(const n of e){console.debug("deleteResources: fullNameExt: "+n);let e,r,a,f,y,p=i.extname(n),m=i.basename(n,p),h=i.join(s,n);if(m!=d&&"Step 2 - Resource Replaced"!=m)try{l.test(m)?(console.debug("deleteResources: filename IS a ResourceId so we will use that to search: "+m),e=m,r=yield o.getResourceById(e),r&&(a=null==r?void 0:r.id,f=null==r?void 0:r.title,y=null==r?void 0:r.user_created_time)):(console.debug("deleteResources: filename NOT a ResourceId, will use fullNameExt to search : "+n),e=n,r=yield o.getResourceByFilename(e),1==r.items.length?(console.debug("deleteResources: originalResource.items.length = 1: "+r.items.length),a=r.items[0].id,f=r.items[0].title,y=r.items[0].user_created_time,console.info(`Resource found with search: ${e}. Its Resource Id is: ${a}`),console.debug(`deleteResources: resourceTitle: ${f} & resourceUserCreatedTime: ${y}`)):r.items.length>1?(console.debug("deleteResources: originalResource.items.length > 1: "+r.items.length),console.info(`More than one resource found with search: ${e}. Not proceeding.`)):console.info(`No resource found with search: ${e}. Not proceeding.`))}catch(t){console.error(`ERROR - GET Resource by search: ${e} ${t}`)}if(a&&f&&y){console.debug(`deleteResources: resourceId ${a}, resourceTitle ${f} & resourceUserCreatedTime ${y} all have values, proceed with delete`);try{yield o.deleteResource(a);try{let e=i.join(u,n);yield c.move(h,e);console.info("Resource deleted, file moved: "+n);let r=[m+p,a,f,y].join("~")+".REPLACE";console.debug("deleteResources: fileResourceReplace: "+r);let o=i.join(u,r);c.ensureFileSync(o),console.debug(".replace file created: "+o),t=!0}catch(e){console.error("ERROR - moving to replaced directory: "+e)}}catch(e){console.error(`ERROR - DELETE Resource: ${a} / ${n} ${e}`)}}}if(t){console.debug("deleteResources: createResourcesProceed: "+t);let e=!1;try{e=yield o.syncConfigured()}catch(e){console.error("ERROR - isSyncConfigured: "+e)}if(e){console.info("Running Synchronise for you - do NOT cancel!");yield o.executeSync()}else{console.debug("No need to wait for sync, going straight to createResources");yield p()}}}))}function p(){return r(this,void 0,void 0,(function*(){const e=yield c.readdirSync(u);for(const t of e)if(f.test(t)){console.debug("createResources: fullNameExtReplace is a REPLACE file: "+t);let e=i.extname(t),n=i.basename(t,e).split("~");console.debug("createResources: fullNameSplit: "+n);let r=n[0],s=n[1],l=n[2],f=+n[3],d=i.join(u,t),y=i.join(u,r),p=i.join(a,r);try{console.debug(`about to postResource: ${l} with resourceId ${s}`);yield o.postResource(s,y,l);console.debug(`about to putResource: ${s} with UserCreatedTime ${f}`);yield o.putResource(s,f);try{yield c.move(y,p,{overwrite:!0}),yield c.removeSync(d)}catch(e){console.error("ERROR - moving files to step 2 directory: "+e)}console.info("Attachment replaced, file moved: "+l)}catch(e){console.error(`ERROR - with either POST and PUT Resource: file: ${l} with resource id: ${s} ${e}`)}}let t=yield o.runOnStartAndAfterSyncSetting();if(console.debug("isRunOnStartAndAfterSync: "+t),t){yield y()}}))}t.init=function(){return r(this,void 0,void 0,(function*(){console.info("Attaché plugin started."),s=yield o.filesPathSetting(),(null==s?void 0:s.length)>0&&(yield c.ensureDir(s),u=i.join(s,d),yield c.ensureDir(u),a=i.join(s,"Step 2 - Resource Replaced"),yield c.ensureDir(a),console.info("Files and directories exist at "+s))}))},t.deleteResources=y,t.createResources=p,t.syncConfiguredAndRunOnStart=function(){return r(this,void 0,void 0,(function*(){let e=yield o.syncConfigured();console.debug("isSyncConfigured: "+e);let t=yield o.runOnStartAndAfterSyncSetting();console.debug("isRunOnStartAndAfterSync: "+t),!e&&t&&(console.debug("!syncConfigured && runOnStartAndAfterSync"),yield y())}))}},function(e,t){e.exports=require("util")},function(e,t){e.exports=require("assert")},function(e,t,n){"use strict";e.exports={copySync:n(28)}},function(e,t){e.exports=e=>{const t=process.versions.node.split(".").map(e=>parseInt(e,10));return e=e.split(".").map(e=>parseInt(e,10)),t[0]>e[0]||t[0]===e[0]&&(t[1]>e[1]||t[1]===e[1]&&t[2]>=e[2])}},function(e,t,n){"use strict";const r=n(0);e.exports={utimesMillis:function(e,t,n,o){r.open(e,"r+",(e,i)=>{if(e)return o(e);r.futimes(i,t,n,e=>{r.close(i,t=>{o&&o(e||t)})})})},utimesMillisSync:function(e,t,n){const o=r.openSync(e,"r+");return r.futimesSync(o,t,n),r.closeSync(o)}}},function(e,t,n){"use strict";const r=n(2).fromCallback;e.exports={copy:r(n(30))}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ContentScriptType=t.SettingStorage=t.AppType=t.SettingItemType=t.ToolbarButtonLocation=t.isContextMenuItemLocation=t.MenuItemLocation=t.ImportModuleOutputFormat=t.FileSystemItem=void 0,function(e){e.File="file",e.Directory="directory"}(t.FileSystemItem||(t.FileSystemItem={})),function(e){e.Markdown="md",e.Html="html"}(t.ImportModuleOutputFormat||(t.ImportModuleOutputFormat={})),function(e){e.File="file",e.Edit="edit",e.View="view",e.Note="note",e.Tools="tools",e.Help="help",e.Context="context",e.NoteListContextMenu="noteListContextMenu",e.EditorContextMenu="editorContextMenu",e.FolderContextMenu="folderContextMenu",e.TagContextMenu="tagContextMenu"}(r=t.MenuItemLocation||(t.MenuItemLocation={})),t.isContextMenuItemLocation=function(e){return[r.Context,r.NoteListContextMenu,r.EditorContextMenu,r.FolderContextMenu,r.TagContextMenu].includes(e)},function(e){e.NoteToolbar="noteToolbar",e.EditorToolbar="editorToolbar"}(t.ToolbarButtonLocation||(t.ToolbarButtonLocation={})),function(e){e[e.Int=1]="Int",e[e.String=2]="String",e[e.Bool=3]="Bool",e[e.Array=4]="Array",e[e.Object=5]="Object",e[e.Button=6]="Button"}(t.SettingItemType||(t.SettingItemType={})),function(e){e.Desktop="desktop",e.Mobile="mobile",e.Cli="cli"}(t.AppType||(t.AppType={})),function(e){e[e.Database=1]="Database",e[e.File=2]="File"}(t.SettingStorage||(t.SettingStorage={})),function(e){e.MarkdownItPlugin="markdownItPlugin",e.CodeMirrorPlugin="codeMirrorPlugin"}(t.ContentScriptType||(t.ContentScriptType={}))},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function c(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(8),i=n(12),c=n(48);o.default.plugins.register({onStart:function(){return r(this,void 0,void 0,(function*(){yield c.registerSettings(),yield i.init(),yield c.registerCommand(),yield c.onSyncCompleteEvent(),yield c.createMenuItems(),yield i.syncConfiguredAndRunOnStart()}))}})},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function c(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.executeSync=t.putResource=t.postResource=t.deleteResource=t.getResourceByFilename=t.getResourceById=t.syncConfigured=t.runOnStartAndAfterSyncSetting=t.syncTargetGlobalSetting=t.filesPathSetting=t.setFilesPathValue=void 0;const o=n(8);function i(){return r(this,void 0,void 0,(function*(){return yield o.default.settings.globalValue("sync.target")}))}t.setFilesPathValue=function(e){return r(this,void 0,void 0,(function*(){yield o.default.settings.setValue("filesPath",e)}))},t.filesPathSetting=function(){return r(this,void 0,void 0,(function*(){return yield o.default.settings.value("filesPath")}))},t.syncTargetGlobalSetting=i,t.runOnStartAndAfterSyncSetting=function(){return r(this,void 0,void 0,(function*(){return yield o.default.settings.value("runOnStartAndAfterSync")}))},t.syncConfigured=function(){return r(this,void 0,void 0,(function*(){let e=yield i();return console.debug("syncTargetValue: "+e),e>0?(console.debug("syncTargetValue > 0"),!0):(console.debug("DEFAULT return false"),!1)}))},t.getResourceById=function(e){return r(this,void 0,void 0,(function*(){return console.debug("getResourceById: resourceId: "+e),yield o.default.data.get(["resources",e],{fields:["id","title","user_created_time"]})}))},t.getResourceByFilename=function(e){return r(this,void 0,void 0,(function*(){return console.debug("getResourceByFilename: resourceSearchString: "+e),yield o.default.data.get(["search"],{query:e,type:"resource",fields:["id","title","user_created_time"]})}))},t.deleteResource=function(e){return r(this,void 0,void 0,(function*(){return yield o.default.data.delete(["resources",e])}))},t.postResource=function(e,t,n){return r(this,void 0,void 0,(function*(){return yield o.default.data.post(["resources"],null,{id:e,title:n},[{path:t}])}))},t.putResource=function(e,t){return r(this,void 0,void 0,(function*(){return console.debug("putResource: userCreatedTime: "+t),yield o.default.data.put(["resources",e],null,{user_created_time:t})}))},t.executeSync=function(){return r(this,void 0,void 0,(function*(){o.default.commands.execute("synchronize")}))}},function(e,t,n){"use strict";e.exports={...n(5),...n(15),...n(18),...n(31),...n(33),...n(39),...n(3),...n(44),...n(46),...n(11),...n(4),...n(7)};const r=n(9);Object.getOwnPropertyDescriptor(r,"promises")&&Object.defineProperty(e.exports,"promises",{get:()=>r.promises})},function(e,t,n){var r=n(24),o=process.cwd,i=null,c=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return i||(i=o.call(process)),i};try{process.cwd()}catch(e){}if("function"==typeof process.chdir){var s=process.chdir;process.chdir=function(e){i=null,s.call(process,e)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,s)}e.exports=function(e){r.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&function(e){e.lchmod=function(t,n,o){e.open(t,r.O_WRONLY|r.O_SYMLINK,n,(function(t,r){t?o&&o(t):e.fchmod(r,n,(function(t){e.close(r,(function(e){o&&o(t||e)}))}))}))},e.lchmodSync=function(t,n){var o,i=e.openSync(t,r.O_WRONLY|r.O_SYMLINK,n),c=!0;try{o=e.fchmodSync(i,n),c=!1}finally{if(c)try{e.closeSync(i)}catch(e){}else e.closeSync(i)}return o}}(e);e.lutimes||function(e){r.hasOwnProperty("O_SYMLINK")?(e.lutimes=function(t,n,o,i){e.open(t,r.O_SYMLINK,(function(t,r){t?i&&i(t):e.futimes(r,n,o,(function(t){e.close(r,(function(e){i&&i(t||e)}))}))}))},e.lutimesSync=function(t,n,o){var i,c=e.openSync(t,r.O_SYMLINK),s=!0;try{i=e.futimesSync(c,n,o),s=!1}finally{if(s)try{e.closeSync(c)}catch(e){}else e.closeSync(c)}return i}):(e.lutimes=function(e,t,n,r){r&&process.nextTick(r)},e.lutimesSync=function(){})}(e);e.chown=i(e.chown),e.fchown=i(e.fchown),e.lchown=i(e.lchown),e.chmod=n(e.chmod),e.fchmod=n(e.fchmod),e.lchmod=n(e.lchmod),e.chownSync=s(e.chownSync),e.fchownSync=s(e.fchownSync),e.lchownSync=s(e.lchownSync),e.chmodSync=o(e.chmodSync),e.fchmodSync=o(e.fchmodSync),e.lchmodSync=o(e.lchmodSync),e.stat=u(e.stat),e.fstat=u(e.fstat),e.lstat=u(e.lstat),e.statSync=a(e.statSync),e.fstatSync=a(e.fstatSync),e.lstatSync=a(e.lstatSync),e.lchmod||(e.lchmod=function(e,t,n){n&&process.nextTick(n)},e.lchmodSync=function(){});e.lchown||(e.lchown=function(e,t,n,r){r&&process.nextTick(r)},e.lchownSync=function(){});"win32"===c&&(e.rename=(t=e.rename,function(n,r,o){var i=Date.now(),c=0;t(n,r,(function s(u){if(u&&("EACCES"===u.code||"EPERM"===u.code)&&Date.now()-i<6e4)return setTimeout((function(){e.stat(r,(function(e,i){e&&"ENOENT"===e.code?t(n,r,s):o(u)}))}),c),void(c<100&&(c+=10));o&&o(u)}))}));var t;function n(t){return t?function(n,r,o){return t.call(e,n,r,(function(e){l(e)&&(e=null),o&&o.apply(this,arguments)}))}:t}function o(t){return t?function(n,r){try{return t.call(e,n,r)}catch(e){if(!l(e))throw e}}:t}function i(t){return t?function(n,r,o,i){return t.call(e,n,r,o,(function(e){l(e)&&(e=null),i&&i.apply(this,arguments)}))}:t}function s(t){return t?function(n,r,o){try{return t.call(e,n,r,o)}catch(e){if(!l(e))throw e}}:t}function u(t){return t?function(n,r,o){function i(e,t){t&&(t.uid<0&&(t.uid+=4294967296),t.gid<0&&(t.gid+=4294967296)),o&&o.apply(this,arguments)}return"function"==typeof r&&(o=r,r=null),r?t.call(e,n,r,i):t.call(e,n,i)}:t}function a(t){return t?function(n,r){var o=r?t.call(e,n,r):t.call(e,n);return o.uid<0&&(o.uid+=4294967296),o.gid<0&&(o.gid+=4294967296),o}:t}function l(e){return!e||("ENOSYS"===e.code||!(process.getuid&&0===process.getuid()||"EINVAL"!==e.code&&"EPERM"!==e.code))}e.read=function(t){function n(n,r,o,i,c,s){var u;if(s&&"function"==typeof s){var a=0;u=function(l,f,d){if(l&&"EAGAIN"===l.code&&a<10)return a++,t.call(e,n,r,o,i,c,u);s.apply(this,arguments)}}return t.call(e,n,r,o,i,c,u)}return Object.setPrototypeOf&&Object.setPrototypeOf(n,t),n}(e.read),e.readSync=(f=e.readSync,function(t,n,r,o,i){for(var c=0;;)try{return f.call(e,t,n,r,o,i)}catch(e){if("EAGAIN"===e.code&&c<10){c++;continue}throw e}});var f}},function(e,t){e.exports=require("constants")},function(e,t,n){var r=n(26).Stream;e.exports=function(e){return{ReadStream:function t(n,o){if(!(this instanceof t))return new t(n,o);r.call(this);var i=this;this.path=n,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=65536,o=o||{};for(var c=Object.keys(o),s=0,u=c.length;s<u;s++){var a=c[s];this[a]=o[a]}this.encoding&&this.setEncoding(this.encoding);if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(void 0===this.end)this.end=1/0;else if("number"!=typeof this.end)throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(null!==this.fd)return void process.nextTick((function(){i._read()}));e.open(this.path,this.flags,this.mode,(function(e,t){if(e)return i.emit("error",e),void(i.readable=!1);i.fd=t,i.emit("open",t),i._read()}))},WriteStream:function t(n,o){if(!(this instanceof t))return new t(n,o);r.call(this),this.path=n,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,o=o||{};for(var i=Object.keys(o),c=0,s=i.length;c<s;c++){var u=i[c];this[u]=o[u]}if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],null===this.fd&&(this._open=e.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}}},function(e,t){e.exports=require("stream")},function(e,t,n){"use strict";e.exports=function(e){if(null===e||"object"!=typeof e)return e;if(e instanceof Object)var t={__proto__:r(e)};else t=Object.create(null);return Object.getOwnPropertyNames(e).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})),t};var r=Object.getPrototypeOf||function(e){return e.__proto__}},function(e,t,n){"use strict";const r=n(0),o=n(1),i=n(3).mkdirsSync,c=n(17).utimesMillisSync,s=n(6);function u(e,t,n,i){if(!i.filter||i.filter(t,n))return function(e,t,n,i){const c=(i.dereference?r.statSync:r.lstatSync)(t);if(c.isDirectory())return function(e,t,n,o,i){if(!t)return function(e,t,n,o){return r.mkdirSync(n),f(t,n,o),l(n,e)}(e.mode,n,o,i);if(t&&!t.isDirectory())throw new Error(`Cannot overwrite non-directory '${o}' with directory '${n}'.`);return f(n,o,i)}(c,e,t,n,i);if(c.isFile()||c.isCharacterDevice()||c.isBlockDevice())return function(e,t,n,o,i){return t?function(e,t,n,o){if(o.overwrite)return r.unlinkSync(n),a(e,t,n,o);if(o.errorOnExist)throw new Error(`'${n}' already exists`)}(e,n,o,i):a(e,n,o,i)}(c,e,t,n,i);if(c.isSymbolicLink())return function(e,t,n,i){let c=r.readlinkSync(t);i.dereference&&(c=o.resolve(process.cwd(),c));if(e){let e;try{e=r.readlinkSync(n)}catch(e){if("EINVAL"===e.code||"UNKNOWN"===e.code)return r.symlinkSync(c,n);throw e}if(i.dereference&&(e=o.resolve(process.cwd(),e)),s.isSrcSubdir(c,e))throw new Error(`Cannot copy '${c}' to a subdirectory of itself, '${e}'.`);if(r.statSync(n).isDirectory()&&s.isSrcSubdir(e,c))throw new Error(`Cannot overwrite '${e}' with '${c}'.`);return function(e,t){return r.unlinkSync(t),r.symlinkSync(e,t)}(c,n)}return r.symlinkSync(c,n)}(e,t,n,i)}(e,t,n,i)}function a(e,t,n,o){return r.copyFileSync(t,n),o.preserveTimestamps&&function(e,t,n){(function(e){return 0==(128&e)})(e)&&function(e,t){l(e,128|t)}(n,e);(function(e,t){const n=r.statSync(e);c(t,n.atime,n.mtime)})(t,n)}(e.mode,t,n),l(n,e.mode)}function l(e,t){return r.chmodSync(e,t)}function f(e,t,n){r.readdirSync(e).forEach(r=>function(e,t,n,r){const i=o.join(t,e),c=o.join(n,e),{destStat:a}=s.checkPathsSync(i,c,"copy");return u(a,i,c,r)}(r,e,t,n))}e.exports=function(e,t,n){"function"==typeof n&&(n={filter:n}),(n=n||{}).clobber=!("clobber"in n)||!!n.clobber,n.overwrite="overwrite"in n?!!n.overwrite:n.clobber,n.preserveTimestamps&&"ia32"===process.arch&&console.warn("fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;\n\n    see https://github.com/jprichardson/node-fs-extra/issues/269");const{srcStat:c,destStat:a}=s.checkPathsSync(e,t,"copy");return s.checkParentPathsSync(e,c,t,"copy"),function(e,t,n,c){if(c.filter&&!c.filter(t,n))return;const s=o.dirname(n);r.existsSync(s)||i(s);return u(e,t,n,c)}(a,e,t,n)}},function(e,t,n){"use strict";const r=n(5),o=n(1),i=n(16)("10.12.0"),c=e=>{if("win32"===process.platform){if(/[<>:"|?*]/.test(e.replace(o.parse(e).root,""))){const t=new Error("Path contains invalid characters: "+e);throw t.code="EINVAL",t}}},s=e=>("number"==typeof e&&(e={mode:e}),{mode:511,...e}),u=e=>{const t=new Error(`operation not permitted, mkdir '${e}'`);return t.code="EPERM",t.errno=-4048,t.path=e,t.syscall="mkdir",t};e.exports.makeDir=async(e,t)=>{if(c(e),t=s(t),i){const n=o.resolve(e);return r.mkdir(n,{mode:t.mode,recursive:!0})}const n=async e=>{try{await r.mkdir(e,t.mode)}catch(t){if("EPERM"===t.code)throw t;if("ENOENT"===t.code){if(o.dirname(e)===e)throw u(e);if(t.message.includes("null bytes"))throw t;return await n(o.dirname(e)),n(e)}try{if(!(await r.stat(e)).isDirectory())throw new Error("The path is not a directory")}catch{throw t}}};return n(o.resolve(e))},e.exports.makeDirSync=(e,t)=>{if(c(e),t=s(t),i){const n=o.resolve(e);return r.mkdirSync(n,{mode:t.mode,recursive:!0})}const n=e=>{try{r.mkdirSync(e,t.mode)}catch(t){if("EPERM"===t.code)throw t;if("ENOENT"===t.code){if(o.dirname(e)===e)throw u(e);if(t.message.includes("null bytes"))throw t;return n(o.dirname(e)),n(e)}try{if(!r.statSync(e).isDirectory())throw new Error("The path is not a directory")}catch{throw t}}};return n(o.resolve(e))}},function(e,t,n){"use strict";const r=n(0),o=n(1),i=n(3).mkdirs,c=n(4).pathExists,s=n(17).utimesMillis,u=n(6);function a(e,t,n,r,s){const u=o.dirname(n);c(u,(o,c)=>o?s(o):c?f(e,t,n,r,s):void i(u,o=>o?s(o):f(e,t,n,r,s)))}function l(e,t,n,r,o,i){Promise.resolve(o.filter(n,r)).then(c=>c?e(t,n,r,o,i):i(),e=>i(e))}function f(e,t,n,r,o){return r.filter?l(d,e,t,n,r,o):d(e,t,n,r,o)}function d(e,t,n,o,i){(o.dereference?r.stat:r.lstat)(t,(c,s)=>c?i(c):s.isDirectory()?function(e,t,n,o,i,c){if(!t)return function(e,t,n,o,i){r.mkdir(n,r=>{if(r)return i(r);h(t,n,o,t=>t?i(t):m(n,e,i))})}(e.mode,n,o,i,c);if(t&&!t.isDirectory())return c(new Error(`Cannot overwrite non-directory '${o}' with directory '${n}'.`));return h(n,o,i,c)}(s,e,t,n,o,i):s.isFile()||s.isCharacterDevice()||s.isBlockDevice()?function(e,t,n,o,i,c){return t?function(e,t,n,o,i){if(!o.overwrite)return o.errorOnExist?i(new Error(`'${n}' already exists`)):i();r.unlink(n,r=>r?i(r):y(e,t,n,o,i))}(e,n,o,i,c):y(e,n,o,i,c)}(s,e,t,n,o,i):s.isSymbolicLink()?v(e,t,n,o,i):void 0)}function y(e,t,n,o,i){r.copyFile(t,n,r=>r?i(r):o.preserveTimestamps?function(e,t,n,r){if(function(e){return 0==(128&e)}(e))return function(e,t,n){return m(e,128|t,n)}(n,e,o=>o?r(o):p(e,t,n,r));return p(e,t,n,r)}(e.mode,t,n,i):m(n,e.mode,i))}function p(e,t,n,o){!function(e,t,n){r.stat(e,(e,r)=>e?n(e):s(t,r.atime,r.mtime,n))}(t,n,t=>t?o(t):m(n,e,o))}function m(e,t,n){return r.chmod(e,t,n)}function h(e,t,n,o){r.readdir(e,(r,i)=>r?o(r):S(i,e,t,n,o))}function S(e,t,n,r,i){const c=e.pop();return c?function(e,t,n,r,i,c){const s=o.join(n,t),a=o.join(r,t);u.checkPaths(s,a,"copy",(t,o)=>{if(t)return c(t);const{destStat:u}=o;f(u,s,a,i,t=>t?c(t):S(e,n,r,i,c))})}(e,c,t,n,r,i):i()}function v(e,t,n,i,c){r.readlink(t,(t,s)=>t?c(t):(i.dereference&&(s=o.resolve(process.cwd(),s)),e?void r.readlink(n,(t,a)=>t?"EINVAL"===t.code||"UNKNOWN"===t.code?r.symlink(s,n,c):c(t):(i.dereference&&(a=o.resolve(process.cwd(),a)),u.isSrcSubdir(s,a)?c(new Error(`Cannot copy '${s}' to a subdirectory of itself, '${a}'.`)):e.isDirectory()&&u.isSrcSubdir(a,s)?c(new Error(`Cannot overwrite '${a}' with '${s}'.`)):function(e,t,n){r.unlink(t,o=>o?n(o):r.symlink(e,t,n))}(s,n,c))):r.symlink(s,n,c)))}e.exports=function(e,t,n,r){"function"!=typeof n||r?"function"==typeof n&&(n={filter:n}):(r=n,n={}),r=r||function(){},(n=n||{}).clobber=!("clobber"in n)||!!n.clobber,n.overwrite="overwrite"in n?!!n.overwrite:n.clobber,n.preserveTimestamps&&"ia32"===process.arch&&console.warn("fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;\n\n    see https://github.com/jprichardson/node-fs-extra/issues/269"),u.checkPaths(e,t,"copy",(o,i)=>{if(o)return r(o);const{srcStat:c,destStat:s}=i;u.checkParentPaths(e,c,t,"copy",o=>o?r(o):n.filter?l(a,s,e,t,n,r):a(s,e,t,n,r))})}},function(e,t,n){"use strict";const r=n(2).fromCallback,o=n(0),i=n(1),c=n(3),s=n(7),u=r((function(e,t){t=t||function(){},o.readdir(e,(n,r)=>{if(n)return c.mkdirs(e,t);r=r.map(t=>i.join(e,t)),function e(){const n=r.pop();if(!n)return t();s.remove(n,n=>{if(n)return t(n);e()})}()})}));function a(e){let t;try{t=o.readdirSync(e)}catch{return c.mkdirsSync(e)}t.forEach(t=>{t=i.join(e,t),s.removeSync(t)})}e.exports={emptyDirSync:a,emptydirSync:a,emptyDir:u,emptydir:u}},function(e,t,n){"use strict";const r=n(0),o=n(1),i=n(14),c="win32"===process.platform;function s(e){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(t=>{e[t]=e[t]||r[t],e[t+="Sync"]=e[t]||r[t]}),e.maxBusyTries=e.maxBusyTries||3}function u(e,t,n){let r=0;"function"==typeof t&&(n=t,t={}),i(e,"rimraf: missing path"),i.strictEqual(typeof e,"string","rimraf: path should be a string"),i.strictEqual(typeof n,"function","rimraf: callback function required"),i(t,"rimraf: invalid options argument provided"),i.strictEqual(typeof t,"object","rimraf: options should be object"),s(t),a(e,t,(function o(i){if(i){if(("EBUSY"===i.code||"ENOTEMPTY"===i.code||"EPERM"===i.code)&&r<t.maxBusyTries){r++;return setTimeout(()=>a(e,t,o),100*r)}"ENOENT"===i.code&&(i=null)}n(i)}))}function a(e,t,n){i(e),i(t),i("function"==typeof n),t.lstat(e,(r,o)=>r&&"ENOENT"===r.code?n(null):r&&"EPERM"===r.code&&c?l(e,t,r,n):o&&o.isDirectory()?d(e,t,r,n):void t.unlink(e,r=>{if(r){if("ENOENT"===r.code)return n(null);if("EPERM"===r.code)return c?l(e,t,r,n):d(e,t,r,n);if("EISDIR"===r.code)return d(e,t,r,n)}return n(r)}))}function l(e,t,n,r){i(e),i(t),i("function"==typeof r),t.chmod(e,438,o=>{o?r("ENOENT"===o.code?null:n):t.stat(e,(o,i)=>{o?r("ENOENT"===o.code?null:n):i.isDirectory()?d(e,t,n,r):t.unlink(e,r)})})}function f(e,t,n){let r;i(e),i(t);try{t.chmodSync(e,438)}catch(e){if("ENOENT"===e.code)return;throw n}try{r=t.statSync(e)}catch(e){if("ENOENT"===e.code)return;throw n}r.isDirectory()?p(e,t,n):t.unlinkSync(e)}function d(e,t,n,r){i(e),i(t),i("function"==typeof r),t.rmdir(e,c=>{!c||"ENOTEMPTY"!==c.code&&"EEXIST"!==c.code&&"EPERM"!==c.code?c&&"ENOTDIR"===c.code?r(n):r(c):function(e,t,n){i(e),i(t),i("function"==typeof n),t.readdir(e,(r,i)=>{if(r)return n(r);let c,s=i.length;if(0===s)return t.rmdir(e,n);i.forEach(r=>{u(o.join(e,r),t,r=>{if(!c)return r?n(c=r):void(0==--s&&t.rmdir(e,n))})})})}(e,t,r)})}function y(e,t){let n;s(t=t||{}),i(e,"rimraf: missing path"),i.strictEqual(typeof e,"string","rimraf: path should be a string"),i(t,"rimraf: missing options"),i.strictEqual(typeof t,"object","rimraf: options should be object");try{n=t.lstatSync(e)}catch(n){if("ENOENT"===n.code)return;"EPERM"===n.code&&c&&f(e,t,n)}try{n&&n.isDirectory()?p(e,t,null):t.unlinkSync(e)}catch(n){if("ENOENT"===n.code)return;if("EPERM"===n.code)return c?f(e,t,n):p(e,t,n);if("EISDIR"!==n.code)throw n;p(e,t,n)}}function p(e,t,n){i(e),i(t);try{t.rmdirSync(e)}catch(r){if("ENOTDIR"===r.code)throw n;if("ENOTEMPTY"===r.code||"EEXIST"===r.code||"EPERM"===r.code)!function(e,t){if(i(e),i(t),t.readdirSync(e).forEach(n=>y(o.join(e,n),t)),!c){return t.rmdirSync(e,t)}{const n=Date.now();do{try{return t.rmdirSync(e,t)}catch{}}while(Date.now()-n<500)}}(e,t);else if("ENOENT"!==r.code)throw r}}e.exports=u,u.sync=y},function(e,t,n){"use strict";const r=n(34),o=n(35),i=n(36);e.exports={createFile:r.createFile,createFileSync:r.createFileSync,ensureFile:r.createFile,ensureFileSync:r.createFileSync,createLink:o.createLink,createLinkSync:o.createLinkSync,ensureLink:o.createLink,ensureLinkSync:o.createLinkSync,createSymlink:i.createSymlink,createSymlinkSync:i.createSymlinkSync,ensureSymlink:i.createSymlink,ensureSymlinkSync:i.createSymlinkSync}},function(e,t,n){"use strict";const r=n(2).fromCallback,o=n(1),i=n(0),c=n(3);e.exports={createFile:r((function(e,t){function n(){i.writeFile(e,"",e=>{if(e)return t(e);t()})}i.stat(e,(r,s)=>{if(!r&&s.isFile())return t();const u=o.dirname(e);i.stat(u,(e,r)=>{if(e)return"ENOENT"===e.code?c.mkdirs(u,e=>{if(e)return t(e);n()}):t(e);r.isDirectory()?n():i.readdir(u,e=>{if(e)return t(e)})})})})),createFileSync:function(e){let t;try{t=i.statSync(e)}catch{}if(t&&t.isFile())return;const n=o.dirname(e);try{i.statSync(n).isDirectory()||i.readdirSync(n)}catch(e){if(!e||"ENOENT"!==e.code)throw e;c.mkdirsSync(n)}i.writeFileSync(e,"")}}},function(e,t,n){"use strict";const r=n(2).fromCallback,o=n(1),i=n(0),c=n(3),s=n(4).pathExists;e.exports={createLink:r((function(e,t,n){function r(e,t){i.link(e,t,e=>{if(e)return n(e);n(null)})}s(t,(u,a)=>u?n(u):a?n(null):void i.lstat(e,i=>{if(i)return i.message=i.message.replace("lstat","ensureLink"),n(i);const u=o.dirname(t);s(u,(o,i)=>o?n(o):i?r(e,t):void c.mkdirs(u,o=>{if(o)return n(o);r(e,t)}))}))})),createLinkSync:function(e,t){if(i.existsSync(t))return;try{i.lstatSync(e)}catch(e){throw e.message=e.message.replace("lstat","ensureLink"),e}const n=o.dirname(t);return i.existsSync(n)||c.mkdirsSync(n),i.linkSync(e,t)}}},function(e,t,n){"use strict";const r=n(2).fromCallback,o=n(1),i=n(0),c=n(3),s=c.mkdirs,u=c.mkdirsSync,a=n(37),l=a.symlinkPaths,f=a.symlinkPathsSync,d=n(38),y=d.symlinkType,p=d.symlinkTypeSync,m=n(4).pathExists;e.exports={createSymlink:r((function(e,t,n,r){r="function"==typeof n?n:r,n="function"!=typeof n&&n,m(t,(c,u)=>c?r(c):u?r(null):void l(e,t,(c,u)=>{if(c)return r(c);e=u.toDst,y(u.toCwd,n,(n,c)=>{if(n)return r(n);const u=o.dirname(t);m(u,(n,o)=>n?r(n):o?i.symlink(e,t,c,r):void s(u,n=>{if(n)return r(n);i.symlink(e,t,c,r)}))})}))})),createSymlinkSync:function(e,t,n){if(i.existsSync(t))return;const r=f(e,t);e=r.toDst,n=p(r.toCwd,n);const c=o.dirname(t);return i.existsSync(c)||u(c),i.symlinkSync(e,t,n)}}},function(e,t,n){"use strict";const r=n(1),o=n(0),i=n(4).pathExists;e.exports={symlinkPaths:function(e,t,n){if(r.isAbsolute(e))return o.lstat(e,t=>t?(t.message=t.message.replace("lstat","ensureSymlink"),n(t)):n(null,{toCwd:e,toDst:e}));{const c=r.dirname(t),s=r.join(c,e);return i(s,(t,i)=>t?n(t):i?n(null,{toCwd:s,toDst:e}):o.lstat(e,t=>t?(t.message=t.message.replace("lstat","ensureSymlink"),n(t)):n(null,{toCwd:e,toDst:r.relative(c,e)})))}},symlinkPathsSync:function(e,t){let n;if(r.isAbsolute(e)){if(n=o.existsSync(e),!n)throw new Error("absolute srcpath does not exist");return{toCwd:e,toDst:e}}{const i=r.dirname(t),c=r.join(i,e);if(n=o.existsSync(c),n)return{toCwd:c,toDst:e};if(n=o.existsSync(e),!n)throw new Error("relative srcpath does not exist");return{toCwd:e,toDst:r.relative(i,e)}}}}},function(e,t,n){"use strict";const r=n(0);e.exports={symlinkType:function(e,t,n){if(n="function"==typeof t?t:n,t="function"!=typeof t&&t)return n(null,t);r.lstat(e,(e,r)=>{if(e)return n(null,"file");t=r&&r.isDirectory()?"dir":"file",n(null,t)})},symlinkTypeSync:function(e,t){let n;if(t)return t;try{n=r.lstatSync(e)}catch{return"file"}return n&&n.isDirectory()?"dir":"file"}}},function(e,t,n){"use strict";const r=n(2).fromPromise,o=n(40);o.outputJson=r(n(42)),o.outputJsonSync=n(43),o.outputJSON=o.outputJson,o.outputJSONSync=o.outputJsonSync,o.writeJSON=o.writeJson,o.writeJSONSync=o.writeJsonSync,o.readJSON=o.readJson,o.readJSONSync=o.readJsonSync,e.exports=o},function(e,t,n){"use strict";const r=n(41);e.exports={readJson:r.readFile,readJsonSync:r.readFileSync,writeJson:r.writeFile,writeJsonSync:r.writeFileSync}},function(e,t,n){let r;try{r=n(0)}catch(e){r=n(9)}const o=n(2),{stringify:i,stripBom:c}=n(10);const s={readFile:o.fromPromise((async function(e,t={}){"string"==typeof t&&(t={encoding:t});const n=t.fs||r,i=!("throws"in t)||t.throws;let s,u=await o.fromCallback(n.readFile)(e,t);u=c(u);try{s=JSON.parse(u,t?t.reviver:null)}catch(t){if(i)throw t.message=`${e}: ${t.message}`,t;return null}return s})),readFileSync:function(e,t={}){"string"==typeof t&&(t={encoding:t});const n=t.fs||r,o=!("throws"in t)||t.throws;try{let r=n.readFileSync(e,t);return r=c(r),JSON.parse(r,t.reviver)}catch(t){if(o)throw t.message=`${e}: ${t.message}`,t;return null}},writeFile:o.fromPromise((async function(e,t,n={}){const c=n.fs||r,s=i(t,n);await o.fromCallback(c.writeFile)(e,s,n)})),writeFileSync:function(e,t,n={}){const o=n.fs||r,c=i(t,n);return o.writeFileSync(e,c,n)}};e.exports=s},function(e,t,n){"use strict";const{stringify:r}=n(10),{outputFile:o}=n(11);e.exports=async function(e,t,n={}){const i=r(t,n);await o(e,i,n)}},function(e,t,n){"use strict";const{stringify:r}=n(10),{outputFileSync:o}=n(11);e.exports=function(e,t,n){const i=r(t,n);o(e,i,n)}},function(e,t,n){"use strict";e.exports={moveSync:n(45)}},function(e,t,n){"use strict";const r=n(0),o=n(1),i=n(15).copySync,c=n(7).removeSync,s=n(3).mkdirpSync,u=n(6);function a(e,t,n){try{r.renameSync(e,t)}catch(r){if("EXDEV"!==r.code)throw r;return function(e,t,n){return i(e,t,{overwrite:n,errorOnExist:true}),c(e)}(e,t,n)}}e.exports=function(e,t,n){const i=(n=n||{}).overwrite||n.clobber||!1,{srcStat:l}=u.checkPathsSync(e,t,"move");return u.checkParentPathsSync(e,l,t,"move"),s(o.dirname(t)),function(e,t,n){if(n)return c(t),a(e,t,n);if(r.existsSync(t))throw new Error("dest already exists.");return a(e,t,n)}(e,t,i)}},function(e,t,n){"use strict";const r=n(2).fromCallback;e.exports={move:r(n(47))}},function(e,t,n){"use strict";const r=n(0),o=n(1),i=n(18).copy,c=n(7).remove,s=n(3).mkdirp,u=n(4).pathExists,a=n(6);function l(e,t,n,o){r.rename(e,t,r=>r?"EXDEV"!==r.code?o(r):function(e,t,n,r){i(e,t,{overwrite:n,errorOnExist:!0},t=>t?r(t):c(e,r))}(e,t,n,o):o())}e.exports=function(e,t,n,r){"function"==typeof n&&(r=n,n={});const i=n.overwrite||n.clobber||!1;a.checkPaths(e,t,"move",(n,f)=>{if(n)return r(n);const{srcStat:d}=f;a.checkParentPaths(e,d,t,"move",n=>{if(n)return r(n);s(o.dirname(t),n=>n?r(n):function(e,t,n,r){if(n)return c(t,o=>o?r(o):l(e,t,n,r));u(t,(o,i)=>o?r(o):i?r(new Error("dest already exists.")):l(e,t,n,r))}(e,t,i,r))})})}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function c(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.createMenuItems=t.onSyncCompleteEvent=t.registerCommand=t.registerSettings=void 0;const o=n(8),i=n(19),c=n(19),s=n(12);t.registerSettings=function(){return r(this,void 0,void 0,(function*(){yield o.default.settings.registerSection("AttachéSection",{label:"Attaché",iconName:"fas fa-exchange-alt"}),yield o.default.settings.registerSettings({filesPath:{value:"",type:i.SettingItemType.String,section:"AttachéSection",public:!0,label:"Files Path",description:"Path to files that will replace your resources. Restarting Joplin will create this path if doesn't exist."}}),yield o.default.settings.registerSettings({runOnStartAndAfterSync:{value:!1,type:i.SettingItemType.Bool,section:"AttachéSection",public:!0,label:"Run on start and after sync",description:"If checked true, Attaché will run immediately after Joplin starts and after each synchronisation. The default value is unchecked (false)."}})}))},t.registerCommand=function(){return r(this,void 0,void 0,(function*(){yield o.default.commands.register({name:"Attaché",label:"Replace/update attachments",execute:()=>r(this,void 0,void 0,(function*(){yield s.deleteResources()}))})}))},t.onSyncCompleteEvent=function(){return r(this,void 0,void 0,(function*(){o.default.workspace.onSyncComplete(e=>r(this,void 0,void 0,(function*(){console.debug("onSyncComplete event has occurred, about to call createResources"),yield s.createResources()})))}))},t.createMenuItems=function(){return r(this,void 0,void 0,(function*(){yield o.default.views.menuItems.create("myMenuItemToolsAttaché","Attaché",c.MenuItemLocation.Tools)}))}}]);